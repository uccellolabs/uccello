(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{"+lRy":function(t,e){},0:function(t,e,n){n("F/og"),n("XZv6"),t.exports=n("+lRy")},"F/og":function(t,e,n){"use strict";function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}n.r(e);var o=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.initTable(),this.makeQuery()}var e,n,o;return e=t,(n=[{key:"initTable",value:function(){0!=$('table[data-filter-type="list"]').length&&(this.table=$('table[data-filter-type="list"]'))}},{key:"makeQuery",value:function(){var t=this;if(this.table){var e=$(this.table).data("list-url");$.get(e).then(function(e){t.displayResult(e)})}}},{key:"displayResult",value:function(t){var e=this;if(this.table&&t.data){var n=$("thead tr.template",this.table);$("tbody.row",this.table).remove();var a=!0,i=!1,o=void 0;try{for(var r,l=function(){var t=r.value,a=n.clone();$("th[data-field]",e.table).each(function(e,n){var i=$(this).data("field"),o=$(this).data("column"),r=$('td[data-field="'.concat(i,'"] '),a);r.html(t[o]),$(this).is(":visible")||r.hide()}),a.removeClass("hide").removeClass("template").addClass("row").appendTo("tbody",e.table)},c=t.data[Symbol.iterator]();!(a=(r=c.next()).done);a=!0)l()}catch(t){i=!0,o=t}finally{try{a||null==c.return||c.return()}finally{if(i)throw o}}}}},{key:"initListeners",value:function(){this.initSelectFilterListener(),this.initSaveFilterListener(),this.initDeleteFilterListener(),this.initExportListener()}},{key:"initSelectFilterListener",value:function(){var t=$('meta[name="domain"]').attr("content"),e=$('meta[name="module"]').attr("content");$("select.filter").on("change",function(n){var a=n.currentTarget,i=$(a).val();document.location.href=laroute.route("uccello.list",{domain:t,module:e,filter:i})})}},{key:"initSaveFilterListener",value:function(){var t=this;$("#addFilterModal button.save").on("click",function(e){var n=$("#add_filter_filter_name").val();""!==n?$("select.filter option:contains(".concat(n,")")).length>0?swal({title:uctrans("filter.exists.title"),text:uctrans("filter.exists.message"),type:"warning",showCancelButton:!0,closeOnConfirm:!0,confirmButtonColor:"#DD6B55",confirmButtonText:uctrans("button.yes"),cancelButtonText:uctrans("button.cancel")},function(e){!0===e&&t.saveFilter()}):t.saveFilter():$("#add_filter_filter_name").parent(".form-line").addClass("focused error")})}},{key:"initDeleteFilterListener",value:function(){var t=this;$("button.delete-filter").on("click",function(){var e=$("select.filter").val();e&&swal({title:uctrans("dialog.confirm.title"),text:uctrans("filter.delete.message"),type:"warning",showCancelButton:!0,closeOnConfirm:!1,showLoaderOnConfirm:!0,confirmButtonColor:"#DD6B55",confirmButtonText:uctrans("button.yes"),cancelButtonText:uctrans("button.cancel")},function(n){!0===n&&t.deleteFilter(e)})})}},{key:"initExportListener",value:function(){var t=this;$("#exportModal .export").on("click",function(e){var n=$('meta[name="domain"]').attr("content"),a=$('meta[name="module"]').attr("content"),i=$(".listview .dataTable").DataTable(),o=$("#exportModal"),r={_token:$('meta[name="csrf-token"]').attr("content"),extension:$("#export_format",o).val(),columns:t.getVisibleColumns(i),conditions:t.getSearchConditions(i),order:t.getOrderWithFieldColumn(i),hide_columns:$("#export_hide_columns",o).is(":checked")?1:0,with_id:$("#export_with_id",o).is(":checked")?1:0,with_conditions:$("#export_keep_conditions",o).is(":checked")?1:0,with_order:$("#export_keep_order",o).is(":checked")?1:0,with_timestamps:$("#export_with_timestamps",o).is(":checked")?1:0},l=laroute.route("uccello.export",{domain:n,module:a}),c=t.getFakeFormHtml(r,l),s=$(c);$("body").append(s),s.submit(),s.remove()})}},{key:"getVisibleColumns",value:function(t){var e=this.datatable.columns,n=[];return t.columns().every(function(a){a>0&&a<t.columns().visible().length-1&&t.column(a).visible()&&n.push(e[a-1].name)}),n}},{key:"getSearchConditions",value:function(t){var e=this.datatable.columns,n={};return t.columns().every(function(a){a>0&&a<t.columns().visible().length-1&&t.column(a).search()&&(n[e[a-1].name]=t.column(a).search())}),n}},{key:"getOrderWithFieldColumn",value:function(t){var e=this.datatable.columns,n={},a=!0,i=!1,o=void 0;try{for(var r,l=t.order()[Symbol.iterator]();!(a=(r=l.next()).done);a=!0){var c=r.value;n[e[c[0]-1].db_column]=c[1]}}catch(t){i=!0,o=t}finally{try{a||null==l.return||l.return()}finally{if(i)throw o}}return n}},{key:"saveFilter",value:function(){var t=$('meta[name="domain"]').attr("content"),e=$('meta[name="module"]').attr("content"),n=$(".listview .dataTable").DataTable(),a=$("#addFilterModal"),i={_token:$('meta[name="csrf-token"]').attr("content"),name:$("#add_filter_filter_name",a).val(),type:"list",save_order:$("#add_filter_save_order",a).is(":checked")?1:0,save_page_length:$("#add_filter_save_page_length",a).is(":checked")?1:0,columns:this.getVisibleColumns(n),order:n.order(),page_length:parseInt($("button .records-number").text()),public:$("#add_filter_is_public",a).is(":checked")?1:0,default:$("#add_filter_is_default",a).is(":checked")?1:0},o=this.getSearchConditions(n);i.conditions=o!=={}?{search:o}:null;var r=laroute.route("uccello.list.filter.save",{domain:t,module:e});$.ajax({url:r,method:"post",data:i,contentType:"application/x-www-form-urlencoded"}).then(function(t){$("#addFilterModal").modal("hide");var e={id:t.id,name:t.name};0===$("select.filter option[value='".concat(e.id,"']")).length&&$("select.filter").append('<option value="'.concat(e.id,'">').concat(e.name,"</option>")),$("select.filter").val(e.id).selectpicker("refresh"),$("button.delete-filter").removeAttr("disabled")}).fail(function(t){swal(uctrans("dialog.error.title"),t.message,"error")})}},{key:"deleteFilter",value:function(t){var e=$('meta[name="domain"]').attr("content"),n=$('meta[name="module"]').attr("content"),a=laroute.route("uccello.list.filter.delete",{domain:e,module:n,id:t});$.get(a).then(function(t){t.success?document.location.href=laroute.route("uccello.list",{domain:e,module:n}):swal(uctrans("dialog.error.title"),t.message,"error")}).fail(function(t){swal(uctrans("dialog.error.title"),t.message,"error")})}},{key:"getFakeFormHtml",value:function(t,e){var n="<form style='display: none;' method='POST' action='"+e+"'>";return _.each(t,function(t,e){var i="object"===a(t)?JSON.stringify(t):t;"string"==typeof i&&(i=i.replace("\\","\\\\").replace("'","'")),n+="<input type='hidden' name='"+e+"' value='"+i+"'>"}),n+="</form>"}}])&&i(e.prototype,n),o&&i(e,o),t}();function r(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}var l=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.initListeners()}var e,n,a;return e=t,(n=[{key:"initListeners",value:function(){this.initDeleteCurrentFileListener(),this.initSaveAndNewListener()}},{key:"initDeleteCurrentFileListener",value:function(){$(".current-file .delete-file a").on("click",function(t){t.preventDefault(),$(t.currentTarget).parents(".form-group:first").find(".file-field").removeClass("hide"),$(t.currentTarget).parents(".form-group:first").find(".delete-file-field").val(1),$(t.currentTarget).parents(".current-file:first").remove()})}},{key:"initSaveAndNewListener",value:function(){$(".btn-save-new").on("click",function(){$("input[name='save_new_hdn']").val(1),$("form.edit-form").submit()})}}])&&r(e.prototype,n),a&&r(e,a),t}();function c(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}var s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.initRelatedLists(),this.initRelatedListSelectionModalListener()}var e,n,a;return e=t,(n=[{key:"initRelatedLists",value:function(){var t=this;$(".relatedlist .dataTable").each(function(e,n){t.initDatatable(n)})}},{key:"initRelatedListSelectionModalListener",value:function(){var t=this;$(".btn-relatedlist-select").on("click",function(e){var n=e.currentTarget,a=$(n).data("relatedlist"),i=$(n).data("modal-title"),o=$(n).data("modal-icon"),r=$(".selection-modal-content[data-relatedlist='".concat(a,"']")).html(),l=$("#relatedListSelectionModal");$(".modal-title span",l).text(i),$(".modal-title i",l).text(o),$(".modal-body",l).html(r),t.initDatatable($(".dataTable",l),!0),l.modal("show")})}},{key:"initDatatable",value:function(t,e){var n,a=this,i=$('meta[name="csrf-token"]').attr("content"),o=$('meta[name="domain"]').attr("content"),r=$('meta[name="record"]').attr("content"),l=$(t).data("relatedlist"),c=$(t).data("related-module"),s=$(t).data("url"),u=$(t).data("columns"),f="",d="".concat(s,"?id=").concat(r,"&relatedlist=").concat(l);!0===e?(d+="&action=select",f="javascript:void(0)",n=function(t,e,n){a.relatedListNNRowClickCallback(t,e,n,l)}):f=laroute.route("uccello.detail",{id:"%s",domain:o,module:c});var m=new Datatable;m.url="".concat(d,"&_token=").concat(i),m.domainSlug=o,m.moduleName=c,m.columns=u,m.rowUrl=f,m.rowClickCallback=n,m.init(t)}},{key:"relatedListNNRowClickCallback",value:function(t,e,n,a){var i=$('meta[name="domain"]').attr("content"),o=$('meta[name="module"]').attr("content"),r=$('meta[name="record"]').attr("content"),l=laroute.route("uccello.edit.relation.add",{domain:i,module:o,id:r,relatedlist:a,related_id:n.id});$.get(l).then(function(t){!1===t.success?swal(uctrans("dialog.error.title"),t.message,"error"):($("#relatedListSelectionModal").modal("hide"),$(".relatedlist table[data-relatedlist=".concat(a,"]")).DataTable().draw())})}}])&&c(e.prototype,n),a&&c(e,a),t}();function u(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}var f=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,a;return e=t,(n=[{key:"show",value:function(t,e){swal(t,e)}}])&&u(e.prototype,n),a&&u(e,a),t}();function d(t){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function m(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}var h=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),!1!==e&&this.initListeners()}var e,n,a;return e=t,(n=[{key:"initListeners",value:function(){this.initClickListener()}},{key:"initClickListener",value:function(t){var e=this;void 0===t&&(t=null),$("a[data-config], button[data-config]",t).on("click",function(t){t.preventDefault(),e.element=$(t.currentTarget),e.config=e.element.data("config"),e.element.blur(),null===e.config&&(e.config={}),!0===e.config.confirm?e.confirm():e.launchAction()})}},{key:"launchAction",value:function(){switch(this.config.actionType){case"link":this.gotoUrl();break;case"ajax":this.callUrl();break;case"modal":this.showModal()}}},{key:"gotoUrl",value:function(){var t=this.config.target?this.config.target:"_self";window.open(this.element.attr("href"),t)}},{key:"callUrl",value:function(){var t=this.element.attr("href"),e="object"===d(this.config.ajax)?this.config.ajax:{},n="get";e.method&&(n=e.method);var a={};if(e.params&&(a=e.params),"post"===n){var i=$('meta[name="csrf-token"]').attr("content");a._token=i}var o=null;e.elementToUpdate&&(o=e.elementToUpdate),$.ajax({url:t,method:n,data:a}).then(function(t){o?$(o).html(t.content):!1===t.success?swal(uctrans("dialog.error.title"),t.message,"error"):(swal(uctrans("dialog.success.title"),t.message,"success"),!0===e.refresh&&document.location.reload())}).catch(function(t){swal(uctrans("dialog.error.title"),t.message,"error")})}},{key:"showModal",value:function(){var t=this.config.modal;$(t).modal("show"),$("input",t).val(""),$(".form-line",t).removeClass("focused").removeClass("error")}},{key:"confirm",value:function(){var t,e,n,a,i,o=this,r=new f;"object"===d(this.config.dialog)&&(t=this.config.dialog.title,e=this.config.dialog.text,n=this.config.dialog.confirmButtonText,a=this.config.dialog.confirmButtonColor,i=this.config.dialog.closeOnConfirm),t||(t=uctrans("dialog.confirm.title")),n||(n=uctrans("button.yes")),a||(a="#DD6B55"),i||(i=!0);var l=!1;"ajax"===this.config.actionType&&(l=!0,this.config.ajax&&this.config.ajax.elementToUpdate||(i=!1)),r.show({title:t,text:e,type:"warning",showCancelButton:!0,confirmButtonColor:a,confirmButtonText:n,cancelButtonText:uctrans("button.cancel"),closeOnConfirm:i,showLoaderOnConfirm:l},function(){o.launchAction()})}}])&&m(e.prototype,n),a&&m(e,a),t}();function v(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}var p=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,a;return e=t,(n=[{key:"show",value:function(t,e,n,a,i,o){e||(e="bg-black"),n||(n="top"),a||(a="right"),i||(i="animated fadeInDown"),o||(o="animated fadeOutUp");$.notify({message:t},{type:e,allow_dismiss:!0,newest_on_top:!0,timer:1e3,placement:{from:n,align:a},animate:{enter:i,exit:o},template:'<div data-notify="container" class="bootstrap-notify-container alert alert-dismissible {0} p-r-35" role="alert"><button type="button" aria-hidden="true" class="close" data-notify="dismiss">Ã—</button><span data-notify="icon"></span> <span data-notify="title">{1}</span> <span data-notify="message">{2}</span><div class="progress" data-notify="progressbar"><div class="progress-bar progress-bar-{0}" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%;"></div></div><a href="{3}" target="{4}" data-notify="url"></a></div>'})}}])&&v(e.prototype,n),a&&v(e,a),t}();function y(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}var b=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.initLinks(),this.initNotifications()}var e,n,a;return e=t,(n=[{key:"initLinks",value:function(){new h}},{key:"initNotifications",value:function(){$(".notification-container").each(function(t,e){var n=$(e).html(),a=$(e).data("color"),i=$(e).data("placement"),o=$(e).data("align"),r=$(e).data("animation-enter"),l=$(e).data("animation-exit");(new p).show(n,a,i,o,r,l)})}}])&&y(e.prototype,n),a&&y(e,a),t}();function g(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.lazyLoad(),this.initGlobal()}var e,n,a;return e=t,(n=[{key:"lazyLoad",value:function(){switch($('meta[name="page"]').attr("content")){case"list":new o;break;case"edit":new l;break;case"detail":new s}}},{key:"initGlobal",value:function(){new b}}])&&g(e.prototype,n),a&&g(e,a),t}())},XZv6:function(t,e){}},[[0,0]]]);