(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{"+lRy":function(t,e){},0:function(t,e,a){a("F/og"),a("XZv6"),t.exports=a("+lRy")},"F/og":function(t,e,a){"use strict";a.r(e);var n=a("ipVs");function r(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function(t,e){if(!t)return;if("string"==typeof t)return i(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);"Object"===a&&t.constructor&&(a=t.constructor.name);if("Map"===a||"Set"===a)return Array.from(t);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return i(t,e)}(t))){var e=0,a=function(){};return{s:a,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,r,l=!0,o=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return l=t.done,t},e:function(t){o=!0,r=t},f:function(){try{l||null==n.return||n.return()}finally{if(o)throw r}}}}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,n=new Array(e);a<e;a++)n[a]=t[a];return n}function l(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var o=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,a,i;return e=t,(a=[{key:"init",value:function(t,e){this.table=$(t),this.linkManager=new n.a(!1),this.rowClickCallback=e,this.initColumns(),this.initColumnsSortListener(),this.initColumnsVisibilityListener(),this.initRecordsNumberListener(),this.initColumnsSearchListener(),this.initRefreshContentEventListener()}},{key:"initColumns",value:function(){var t=this;this.columns={},this.table&&$("th[data-field]",this.table).each((function(e,a){var n=$(a),r=n.data("field");void 0!==r&&(t.columns[r]={columnName:n.data("column"),search:$(".field-search",n).val()})}))}},{key:"makeQuery",value:function(t){var e=this;if(this.table){var a=$(this.table).attr("data-content-url");$("tbody tr.no-results",this.table).hide(),$('.pagination[data-table="'.concat(this.table.attr("id"),'"]')).hide(),$('.loader[data-table="'.concat(this.table.attr("id"),'"]')).show();var n={_token:$('meta[name="csrf-token"]').attr("content"),id:$('meta[name="record"]').attr("content"),columns:this.columns,order:$(this.table).attr("data-order")?JSON.parse($(this.table).attr("data-order")):null,additional_rules:$(this.table).attr("data-additional-rules")?$(this.table).attr("data-additional-rules"):null,relatedlist:$(this.table).attr("data-relatedlist")?$(this.table).attr("data-relatedlist"):null,length:$(this.table).attr("data-length")};void 0!==t&&(n.page=t),$.post(a,n).then((function(t){e.displayResults(t),e.displayPagination(t),$('.loader[data-table="'.concat(e.table.attr("id"),'"]')).hide()})).catch((function(t){$('.loader[data-table="'.concat(e.table.attr("id"),'"]')).addClass("hide"),swal(uctrans.trans("uccello::default.dialog.error.title"),uctrans.trans("uccello::default.dialog.error.message"),"error")})),this.dispatchQueryEvent(this.table.attr("id"),n)}}},{key:"dispatchQueryEvent",value:function(t,e){var a=new CustomEvent("uccello.datatable.query",{detail:{tableId:t,columns:e.columns}});dispatchEvent(a)}},{key:"displayResults",value:function(t){if(this.table&&t.data)if($("tbody tr.record",this.table).remove(),0===t.data.length)$("tbody tr.no-results",this.table).show();else{var e,a=r(t.data);try{for(a.s();!(e=a.n()).done;){var n=e.value;this.addRowToTable(n)}}catch(t){a.e(t)}finally{a.f()}}}},{key:"displayPagination",value:function(t){var e=this;if(this.table&&t.data){var a=t.current_page||1,n=t.last_page,r=a-2,i=a+2;i>n&&(i=n,r=(r=n-4)<1?1:r),r<=1&&(r=1,i=Math.min(5,n));var l,o=null===t.prev_page_url?"disabled":"waves-effect",c=t.prev_page_url?'data-page="'.concat(t.current_page-1,'"'):"",s='<li class="'.concat(o,'"><a href="javascript:void(0);" ').concat(c,'><i class="material-icons">chevron_left</i></a></li>');if(r<=3)for(l=1;l<r;l++)s+=l==a?'<li class="active primary"><a href="javascript:void(0);">'.concat(l,"</a></li>"):'<li class="waves-effect"><a href="javascript:void(0);" data-page="'.concat(l,'">').concat(l,"</a></li>");else s+='<li class="waves-effect"><a href="javascript:void(0);" data-page="1">1</a></li> <li>...</li>';for(l=r;l<=i;l++)s+=l===a?'<li class="active primary"><a href="javascript:void(0);">'.concat(l,"</a></li>"):'<li class="waves-effect"><a href="javascript:void(0);" data-page="'.concat(l,'">').concat(l,"</a></li>");i<n&&(s+='<li>...</li> <li class="waves-effect"><a href="javascript:void(0);" data-page="'.concat(n,'">').concat(n,"</a></li>"));var d=null===t.next_page_url?"disabled":"waves-effect",u=t.next_page_url?'data-page="'.concat(t.current_page+1,'"'):"";s+='<li class="'.concat(d,'"><a href="javascript:void(0);" ').concat(u,'><i class="material-icons">chevron_right</i></a></li>');var f=$('.pagination[data-table="'.concat(this.table.attr("id"),'"]'));f.html(s),f.show(),$("a[data-page]",f).on("click",(function(t){var a=$(t.currentTarget).attr("data-page");e.makeQuery(a)}))}}},{key:"addRowToTable",value:function(t){if(this.table&&t){var e=this,a=$("tbody tr.template",this.table).clone();$("th[data-field]",this.table).each((function(){var e=$(this).data("field"),n=$('td[data-field="'.concat(e,'"] '),a);n.html(t[e+"_html"]),"none"===$(this).css("display")&&n.hide()})),$("a",a).each((function(){var e=$(this).attr("href");e=e.replace("RECORD_ID",t.__primaryKey),$(this).attr("href",e),$(this).attr("data-tooltip")&&$(this).tooltip()}));var n=$(a).attr("data-row-url");n=n.replace("RECORD_ID",t.__primaryKey),$(a).attr("data-row-url",n),$(a).attr("data-record-id",t.__primaryKey),$(a).attr("data-record-label",t.recordLabel),$(a).attr("data-related-record-label",t.__relatedEntityName),$(a).on("click",(function(t){void 0!==e.rowClickCallback?e.rowClickCallback(t,e,$(this).attr("data-record-id"),$(this).attr("data-record-label"),$(this).attr("data-related-record-label")):document.location.href=$(this).attr("data-row-url")})),$("a",a).on("click",(function(t){t.stopPropagation()}));var r=new CustomEvent("uccello.list.row_added",{detail:{element:a,record:t}});dispatchEvent(r),this.linkManager.initClickListener(a),a.removeClass("hide").removeClass("template").addClass("record").appendTo("#".concat(this.table.attr("id")," tbody"))}}},{key:"initColumnsVisibilityListener",value:function(){$('ul.columns[data-table="'.concat(this.table.attr("id"),'"] li a')).on("click",(function(t){var e=$(t.currentTarget),a=$(e).data("field"),n=$(e).parents("li:first");n.toggleClass("active"),n.hasClass("active")?($('th[data-field="'.concat(a,'"]')).show(),$('td[data-field="'.concat(a,'"]')).show()):($('th[data-field="'.concat(a,'"]')).hide(),$('td[data-field="'.concat(a,'"]')).hide())}))}},{key:"initRecordsNumberListener",value:function(){var t=this;this.table&&$('ul.records-number[data-table="'.concat(this.table.attr("id"),'"] li a')).on("click",(function(e){var a=$(e.currentTarget),n=$(a).data("number"),r=$(a).parents("ul:first").attr("id");$('a[data-target="'.concat(r,'"] strong.records-number')).text(n),$(t.table).attr("data-length",n),t.makeQuery()}))}},{key:"initColumnsSearchListener",value:function(){if(this.table){this.timer=0;var t=this;$("th[data-field]",this.table).each((function(e,a){var n=$(a),r=n.data("field");$("input:not(.nosearch)",n).on("keyup apply.daterangepicker cancel.daterangepicker",(function(){t.launchSearch(r,$(this).val())})),$("select:not(.nosearch)",n).on("change",(function(){t.launchSearch(r,$(this).val())}))})),this.addClearSearchButtonListener()}}},{key:"initRefreshContentEventListener",value:function(){var t=this;this.table&&addEventListener("uccello.list.refresh",(function(e){e.detail===$(t.table).attr("id")&&t.makeQuery()}))}},{key:"launchSearch",value:function(t,e){var a=this;this.table&&(""!==e&&$(".clear-search",this.table).show(),this.columns[t].search!==e&&(this.columns[t].search=e,clearTimeout(this.timer),this.timer=setTimeout((function(){a.makeQuery()}),700)))}},{key:"addClearSearchButtonListener",value:function(){var t=this;this.table&&$(".actions-column .clear-search",this.table).on("click",(function(e){$("thead select",t.table).val(""),$("thead input",t.table).val(""),t.initColumns(),$(e.currentTarget).hide(),t.makeQuery()}))}},{key:"initColumnsSortListener",value:function(){var t=this;this.table&&$("th[data-field].sortable",this.table).each((function(e,a){var n=$(a),r=n.data("field");$("a.column-label",n).on("click",(function(e){var a=t.table.attr("data-order")?JSON.parse(t.table.attr("data-order")):null;$("a.column-label i").hide(),null!==a&&"asc"===a[r]?(a[r]="desc",$("a.column-label i",n).removeClass("fa-sort-amount-up").addClass("fa-sort-amount-down")):((a={})[r]="asc",$("a.column-label i",n).removeClass("fa-sort-amount-down").addClass("fa-sort-amount-up")),$("a.column-label i",n).show(),t.table.attr("data-order",JSON.stringify(a)),t.makeQuery()}))}))}}])&&l(e.prototype,a),i&&l(e,i),t}();function c(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.initEntityFields(),this.initListener(),this.fieldName=""}var e,a,n;return e=t,(a=[{key:"initEntityFields",value:function(){0!=$('table[data-filter-type="related-list"]').length&&$(".delete-related-record").on("click",(function(t){var e=$(t.currentTarget).parents(".modal:first"),a=e.attr("data-field");dispatchEvent(new CustomEvent("uccello.uitype.entity.deleted",{detail:{id:$("[name='".concat(a,"']")).val(),fieldName:a}})),$("[name='".concat(a,"']")).val(""),$("#".concat(a,"_display")).val(""),$("#".concat(a,"_display")).parent().find("label").removeClass("active"),$(e).modal("close")}))}},{key:"selectRelatedModule",value:function(t,e,a){var n=$(t.table).parents(".modal:first"),r=n.attr("data-field");$("[name='".concat(r,"']")).val(e).trigger("keyup"),$("#".concat(r,"_display")).val(a),$("#".concat(r,"_display")).parent().find("label").addClass("active"),dispatchEvent(new CustomEvent("uccello.uitype.entity.selected",{detail:{id:e,fieldName:r}})),$(n).modal("close")}},{key:"setUpForm",value:function(t,e){var a=this;$(".create-ajax",e).html(t),this.initMaterializeOnItems();var n=$("#form_popup_"+this.fieldName,e);n.submit((function(t){return $.ajax({url:n.attr("action"),type:"POST",data:n.serialize(),success:function(t){if(t.id&&t.recordLabel){var n=e.attr("data-field");$("[name='".concat(n,"']")).val(t.id).trigger("keyup"),$("#".concat(n,"_display")).val(t.recordLabel),$("#".concat(n,"_display")).parent().find("label").addClass("active"),dispatchEvent(new CustomEvent("uccello.uitype.entity.created",{detail:{id:t.id,fieldName:n}})),$(e).modal("close"),$("a.search-related-record",e).click();var r=new CustomEvent("uccello.list.refresh",{detail:$(".search-related-record table",e).attr("id")});dispatchEvent(r)}else{a.setUpForm(t,e);var i=$(".invalid:first");e.animate({scrollTop:i.offset().top-e.offset().top+e.scrollTop()-30,scrollLeft:0},300)}}}),!1}))}},{key:"initMaterializeOnItems",value:function(){$("select").each((function(t,e){$(e).formSelect({dropdownOptions:{alignment:$(e).data("alignment")?$(e).data("alignment"):"left",constrainWidth:!1!==$(e).data("constrain-width"),container:$(e).data("container")?$($(e).data("container")):null,coverTrigger:!0===$(e).data("cover-trigger"),closeOnClick:!1!==$(e).data("close-on-click"),hover:!0===$(e).data("hover")}})})),$("[data-tooltip]").tooltip({transitionMovement:0}),$(".collapsible").collapsible(),M.updateTextFields()}},{key:"initListener",value:function(){var t=this;$("a.entity-modal").on("click",(function(e){var a=$(e.currentTarget),n=a.attr("data-table"),r=$(a).attr("href"),i=$(r);t.fieldName=n.replace("datatable_","");var l=$("table#"+n),c=new o;if(c.init(l,(function(e,a,n,r){t.selectRelatedModule(a,n,r)})),c.makeQuery(),!$("meta[name='entity-new-tab']").attr("content")){var s=$('meta[name="popup_url_'+t.fieldName+'"]').attr("content");$.get(s,{field:t.fieldName}).then((function(e){t.setUpForm(e,i)}))}}))}}])&&c(e.prototype,a),n&&c(e,n),t}();function d(t){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function u(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function(t,e){if(!t)return;if("string"==typeof t)return f(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);"Object"===a&&t.constructor&&(a=t.constructor.name);if("Map"===a||"Set"===a)return Array.from(t);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return f(t,e)}(t))){var e=0,a=function(){};return{s:a,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,r,i=!0,l=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return i=t.done,t},e:function(t){l=!0,r=t},f:function(){try{i||null==n.return||n.return()}finally{if(l)throw r}}}}function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,n=new Array(e);a<e;a++)n[a]=t[a];return n}function h(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function v(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var m=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.initDatatable(),this.initListeners(),this.initEntityFields(),this.content_url=$("#datatable").attr("data-content-url")}var e,a,n;return e=t,(a=[{key:"initDatatable",value:function(){0!=$('table[data-filter-type="list"]').length&&(this.datatable=new o,this.datatable.init($('table[data-filter-type="list"]')),this.datatable.makeQuery())}},{key:"initListeners",value:function(){this.initSaveFilterListener(),this.initDeleteFilterListener(),this.initExportListener(),this.initDescendantsRecordsFilterEventListener()}},{key:"initSaveFilterListener",value:function(){var t=this;$("#addFilterModal a.save").on("click",(function(e){var a=$("#add_filter_filter_name").val();""!==a?$("ul#filters-list a[data-name='".concat(a,"']")).length>0?swal(h({title:uctrans.trans("uccello::default.filter.exists.title"),text:uctrans.trans("uccello::default.filter.exists.message"),icon:"warning",buttons:!0,dangerMode:!0},"buttons",[uctrans.trans("uccello::default.button.no"),uctrans.trans("uccello::default.button.yes")])).then((function(e){!0===e&&t.saveFilter()})):t.saveFilter():$("#add_filter_filter_name").parent(".form-line").addClass("focused error")}))}},{key:"initDeleteFilterListener",value:function(){var t=this,e=$('table[data-filter-type="list"]');$("a.delete-filter").on("click",(function(){var a=$(e).attr("data-filter-id");a&&swal(h({title:uctrans.trans("uccello::default.confirm.dialog.title"),text:uctrans.trans("uccello::default.filter.delete.message"),icon:"warning",buttons:!0,dangerMode:!0},"buttons",[uctrans.trans("uccello::default.button.no"),uctrans.trans("uccello::default.button.yes")])).then((function(e){!0===e&&t.deleteFilter(a)}))}))}},{key:"initExportListener",value:function(){var t=this;$("#exportModal .export").on("click",(function(e){var a=$('table[data-filter-type="list"]'),n=$("#exportModal"),r={_token:$('meta[name="csrf-token"]').attr("content"),extension:$("#export_format",n).val(),columns:t.getVisibleColumns(a),conditions:t.getSearchConditions(a),order:$(a).attr("data-order")?JSON.parse($(a).attr("data-order")):null,with_hidden_columns:$("#with_hidden_columns",n).is(":checked")?1:0,with_id:$("#export_with_id",n).is(":checked")?1:0,with_conditions:$("#export_keep_conditions",n).is(":checked")?1:0,with_order:$("#export_keep_order",n).is(":checked")?1:0,with_timestamps:$("#export_with_timestamps",n).is(":checked")?1:0,with_descendants:$("#export_with_descendants",n).val()},i=a.data("export-url"),l=t.getFakeFormHtml(r,i),o=$(l);$("body").append(o),o.submit(),o.remove()}))}},{key:"getVisibleColumns",value:function(t){var e=[];return $("th[data-field]",t).each((function(){var t=$(this).data("field");"none"!==$(this).css("display")&&e.push(t)})),e}},{key:"getSearchConditions",value:function(t){var e=this,a={};return $("th[data-column]",t).each((function(t,n){var r=$(n).data("field");e.datatable.columns[r].search&&(a[r]=e.datatable.columns[r].search)})),a}},{key:"getOrderWithFieldColumn",value:function(t){var e,a=this.datatable.columns,n={},r=u(t.order());try{for(r.s();!(e=r.n()).done;){var i=e.value;n[a[i[0]-1].db_column]=i[1]}}catch(t){r.e(t)}finally{r.f()}return n}},{key:"saveFilter",value:function(){var t=$('table[data-filter-type="list"]'),e=$("#addFilterModal"),a={_token:$('meta[name="csrf-token"]').attr("content"),name:$("#add_filter_filter_name",e).val(),type:"list",save_order:$("#add_filter_save_order",e).is(":checked")?1:0,save_page_length:$("#add_filter_save_page_length",e).is(":checked")?1:0,columns:this.getVisibleColumns(t),order:$(t).attr("data-order")?JSON.parse($(t).attr("data-order")):null,page_length:$(t).attr("data-length"),public:$("#add_filter_is_public",e).is(":checked")?1:0,default:$("#add_filter_is_default",e).is(":checked")?1:0},n=this.getSearchConditions(t);a.conditions=n!=={}?{search:n}:null,$.ajax({url:t.data("save-filter-url"),method:"post",data:a,contentType:"application/x-www-form-urlencoded"}).then((function(e){var a={id:e.id,name:e.name};$('a[data-target="filters-list"] span').text(a.name),$(t).attr("data-filter-id",a.id),$("a.delete-filter").parents("li:first").show()})).fail((function(t){swal(uctrans.trans("uccello::default.dialog.error.title"),t.message,"error")}))}},{key:"deleteFilter",value:function(t){var e=$('table[data-filter-type="list"]'),a={_token:$('meta[name="csrf-token"]').attr("content"),id:t},n=$(e).data("delete-filter-url");$.post(n,a).then((function(t){t.success?document.location.href=$(e).data("list-url"):swal(uctrans.trans("uccello::default.dialog.error.title"),t.message,"error")})).fail((function(t){swal(uctrans.trans("uccello::default.dialog.error.title"),t.message,"error")}))}},{key:"getFakeFormHtml",value:function(t,e){var a="<form style='display: none;' method='POST' action='"+e+"'>";return _.each(t,(function(t,e){var n="object"===d(t)?JSON.stringify(t):t;"string"==typeof n&&(n=n.replace("\\","\\\\").replace("'","'")),a+="<input type='hidden' name='"+e+"' value='"+n+"'>"})),a+="</form>"}},{key:"initEntityFields",value:function(){new s}},{key:"initDescendantsRecordsFilterEventListener",value:function(){var t=this;$("[data-descendants-records-filter]").on("click",(function(e){var a=$(this).data("descendants-records-filter"),n=$(this).data("table"),r=$('#dropdown-columns li a[data-field="domain"]');1==a?($("#export_with_descendants").val(1),r.length>0&&($(r).parents("li:first").addClass("active"),$('th[data-field="domain"]').show()),$(this).data("descendants-records-filter",0),$(this).removeClass("primary").addClass("orange")):($("#export_with_descendants").val(0),r.length>0&&($(r).parents("li:first").removeClass("active"),$('th[data-field="domain"]').hide()),$(this).data("descendants-records-filter",1),$(this).removeClass("orange").addClass("primary"));var i=$("#"+n),l=t.content_url+(t.content_url.indexOf("?")>-1?"&":"?")+"descendants="+a;i.attr("data-content-url",l),t.dispatchCustomEvent(n)}))}},{key:"dispatchCustomEvent",value:function(t){var e=new CustomEvent("uccello.list.refresh",{detail:t});dispatchEvent(e)}}])&&v(e.prototype,a),n&&v(e,n),t}();function p(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var b=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.initListeners()}var e,a,n;return e=t,(a=[{key:"initListeners",value:function(){this.initDeleteCurrentFileListener(),this.initSaveAndNewListener(),this.initEntityFields(),this.initEntityModalButtonsListener()}},{key:"initDeleteCurrentFileListener",value:function(){$(".current-file .delete-file a").on("click",(function(t){t.preventDefault(),$(t.currentTarget).parents(".file-field:first").find(".btn").removeClass("hide"),$(t.currentTarget).parents(".file-field:first").find(".file-path-wrapper").removeClass("hide"),$(t.currentTarget).parents(".file-field:first").find(".delete-file-field").val(1),$(t.currentTarget).parents(".current-file:first").remove()}))}},{key:"initSaveAndNewListener",value:function(){$(".btn-save-new").on("click",(function(){$("input[name='save_new_hdn']").val(1),$("form.edit-form").submit()}))}},{key:"initEntityFields",value:function(){new s}},{key:"initEntityModalButtonsListener",value:function(){$("meta[name='entity-new-tab']").attr("content")?$("a.create-related-record").click((function(t){$(t.currentTarget).parents(".modal:first").modal("close")})):($("a.create-related-record").click((function(t){var e=$(t.currentTarget).parents(".modal:first");$("div.create-related-record",e).show(),$("div.search-related-record",e).hide(),$("a.create-related-record",e).hide(),$("a.search-related-record",e).show()})),$("a.search-related-record").click((function(t){var e=$(t.currentTarget).parents(".modal:first");$("div.search-related-record",e).show(),$("div.create-related-record",e).hide(),$("a.search-related-record",e).hide(),$("a.create-related-record",e).show()})))}}])&&p(e.prototype,a),n&&p(e,n),t}();function y(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var g=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.initRelatedLists(),this.initRelatedListSelectionModalListener()}var e,a,n;return e=t,(a=[{key:"initRelatedLists",value:function(){var t=this;0!=$('table[data-filter-type="related-list"]').length&&(this.relatedListDatatables={},$('table[data-filter-type="related-list"]').each((function(e,a){var n=new o;n.init(a),n.makeQuery(),t.relatedListDatatables[$(a).attr("id")]=n})))}},{key:"initRelatedListSelectionModalListener",value:function(){var t=this;$(".btn-relatedlist-select").on("click",(function(e){var a=e.currentTarget,n=$(a).data("relatedlist"),r=$(a).data("modal-title"),i=$(a).data("modal-icon"),l=$(".selection-modal-content[data-relatedlist='".concat(n,"']")).html(),c=$(a).data("table"),s=$("#relatedListSelectionModal");$("h4 span",s).text(r),$("h4 i",s).text(i),$(".modal-body",s).html(l),$("table tbody tr.record",s).remove(),$("table thead .search",s).removeClass("hide");var d=new o;d.init($("table",s),(function(e,a,r,i,l){var o,s,d;l?swal((o={title:uctrans.trans("uccello::default.confirm.dialog.title"),text:uctrans.trans("uccello::default.entity.confirmation_override",{name:l,name_:l}),icon:"warning",buttons:!0,dangerMode:!0},s="buttons",d=[uctrans.trans("uccello::default.button.no"),uctrans.trans("uccello::default.button.yes")],s in o?Object.defineProperty(o,s,{value:d,enumerable:!0,configurable:!0,writable:!0}):o[s]=d,o)).then((function(e){!0===e&&t.relatedListNNRowClickCallback(n,c,a,r)})):t.relatedListNNRowClickCallback(n,c,a,r)})),d.makeQuery()}))}},{key:"relatedListNNRowClickCallback",value:function(t,e,a,n){var r=this,i=$(a.table).data("add-relation-url"),l={_token:$('meta[name="csrf-token"]').attr("content"),id:$('meta[name="record"]').attr("content"),relatedlist:t,related_id:n};$.post(i,l).then((function(t){if(!1===t.success)swal(uctrans.trans("uccello::default.dialog.error.title"),t.message,"error");else{var a=r.relatedListDatatables[e];a&&a.makeQuery(),$("#relatedListSelectionModal").modal("close")}}))}}])&&y(e.prototype,a),n&&y(e,n),t}();function k(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var w=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.initJsTree()}var e,a,n;return e=t,(a=[{key:"initJsTree",value:function(){var t=$("#treeview");t.jstree({core:{themes:{icons:!1},data:{url:function(t){return"#"===t.id?$("meta[name='module-tree-default-url']").attr("content"):$("meta[name='module-tree-children-url']").attr("content")},data:function(t){return{id:t.id}}}},plugins:["search","sort"],search:{show_only_matches:!0}}).on("ready.jstree",(function(){$("meta[name='module-tree-open-all']").attr("content")&&t.jstree("open_all")})).on("changed.jstree",(function(t,e){"#"!==e.node.a_attr.href&&(document.location.href=e.node.a_attr.href)}));var e=!1;$(".treeview-search-bar #record-name").keyup((function(){e&&clearTimeout(e),e=setTimeout((function(){var e=$("#record-name").val();t.jstree(!0).search(e)}),250)}))}}])&&k(e.prototype,a),n&&k(e,n),t}();function C(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.lazyLoad()}var e,a,n;return e=t,(a=[{key:"lazyLoad",value:function(){switch($('meta[name="page"]').attr("content")){case"list":new m;break;case"edit":new b;break;case"detail":new g;break;case"tree":new w}}}])&&C(e.prototype,a),n&&C(e,n),t}())},XZv6:function(t,e){},ipVs:function(t,e,a){"use strict";function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}a.d(e,"a",(function(){return i}));var i=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),!1!==e&&this.initListeners()}var e,a,i;return e=t,(a=[{key:"initListeners",value:function(){this.initClickListener()}},{key:"initClickListener",value:function(t){var e=this;void 0===t&&(t=null),$("a[data-config], button[data-config]",t).on("click",(function(t){t.preventDefault(),t.stopImmediatePropagation(),e.element=$(t.currentTarget),e.config=e.element.data("config"),e.element.blur(),null===e.config&&(e.config={}),!0===e.config.confirm?e.confirm():e.launchAction()}))}},{key:"launchAction",value:function(){switch(this.config.actionType){case"link":this.gotoUrl();break;case"ajax":this.callUrl()}}},{key:"gotoUrl",value:function(){var t=this.config.target?this.config.target:"_self";window.open(this.element.attr("href"),t)}},{key:"callUrl",value:function(){var t=this.element.attr("href"),e="object"===n(this.config.ajax)?this.config.ajax:{},a="get";e.method&&(a=e.method);var r={};if(e.params&&(r=e.params),"post"===a){var i=$('meta[name="csrf-token"]').attr("content");r._token=i}var l=null;e.elementToUpdate&&(l=e.elementToUpdate),$.ajax({url:t,method:a,data:r}).then((function(t){l?$(l).html(t.content):!1===t.success?swal(uctrans.trans("uccello::default.dialog.error.title"),t.message,"error"):(swal(uctrans.trans("uccello::default.dialog.success.title"),t.message,"success"),!0===e.refresh&&document.location.reload())})).catch((function(t){swal(uctrans.trans("uccello::default.dialog.error.title"),t.message,"error")}))}},{key:"confirm",value:function(){var t,e,a,r,i,l=this;"object"===n(this.config.dialog)&&(t=this.config.dialog.title,e=this.config.dialog.text,a=this.config.dialog.confirmButtonText,r=this.config.dialog.confirmButtonColor,i=this.config.dialog.closeOnConfirm),t||(t=uctrans.trans("uccello::default.confirm.dialog.title")),a||(a=uctrans.trans("uccello::default.button.yes")),r||(r="#DD6B55"),i||(i=!0),"ajax"===this.config.actionType&&(this.config.ajax&&this.config.ajax.elementToUpdate||(i=!1)),swal({title:t,text:e,icon:"warning",buttons:{cancel:{text:uctrans.trans("uccello::default.button.no"),value:null,visible:!0},confirm:{text:a,value:!0,className:"red",closeModal:i}}}).then((function(t){!0===t&&l.launchAction()}))}}])&&r(e.prototype,a),i&&r(e,i),t}()}},[[0,0]]]);